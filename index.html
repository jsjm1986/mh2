<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>漫画分镜头脚本生成器</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <script src="lib/pptxgen.bundle.js"></script>
</head>
<body>
    <div class="container">
        <h1>漫画分镜头脚本生成器</h1>
        
        <!-- 添加步骤指示器 -->
        <div class="steps-container">
            <div class="step active" id="step1">
                <div class="step-number">1</div>
                <div class="step-text">输入故事</div>
            </div>
            <div class="step" id="step2">
                <div class="step-number">2</div>
                <div class="step-text">生成分镜</div>
            </div>
            <div class="step" id="step3">
                <div class="step-number">3</div>
                <div class="step-text">导出文档</div>
            </div>
        </div>

        <!-- Token使用统计 -->
        <div class="token-stats">
            <div class="token-info">
                <span>本次使用Token：</span>
                <span id="currentTokens">0</span>
            </div>
            <div class="token-info">
                <span>累计使用Token：</span>
                <span id="totalTokens">0</span>
            </div>
        </div>

        <div class="input-section">
            <textarea id="storyInput" placeholder="请输入您的故事...&#10;&#10;建议：&#10;1. 描述要清晰具体&#10;2. 包含人物对话和情感&#10;3. 说明重要的场景细节"></textarea>
            <div class="word-count">字数：<span id="wordCount">0</span></div>
            <button id="generateBtn" class="primary-btn">生成分镜头脚本</button>
        </div>

        <div class="result-section">
            <div id="loadingIndicator" class="loading" style="display: none;">
                <div class="loading-spinner"></div>
                <div class="loading-text">正在生成中...</div>
                <div class="generation-steps">
                    <div class="generation-step" id="stepAnalyzing">
                        <div class="step-icon">📝</div>
                        <div class="step-content">
                            <div class="step-title">分析故事结构</div>
                            <div class="step-progress"></div>
                        </div>
                    </div>
                    <div class="generation-step" id="stepGenerating">
                        <div class="step-icon">🎬</div>
                        <div class="step-content">
                            <div class="step-title">生成分镜脚本</div>
                            <div class="step-progress"></div>
                        </div>
                    </div>
                    <div class="generation-step" id="stepFormatting">
                        <div class="step-icon">✨</div>
                        <div class="step-content">
                            <div class="step-title">优化输出格式</div>
                            <div class="step-progress"></div>
                        </div>
                    </div>
                </div>
                <div class="loading-progress">总进度: <span id="progressPercent">0</span>%</div>
            </div>
            <div id="resultContainer" class="result-container">
                <!-- 结果将在这里显示 -->
            </div>
            <div class="export-options">
                <button id="exportBtn" class="secondary-btn" style="display: none;">导出PPT文档</button>
                <button id="copyBtn" class="secondary-btn" style="display: none;">复制到剪贴板</button>
            </div>
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html> 